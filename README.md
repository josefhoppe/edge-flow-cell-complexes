

# Representing Edge Flows on Graphs via Sparse Cell Complexes

<img align="right" width="200" style="margin-top:-5px" src="readme_src/LOGO_ERC-FLAG_FP.png">

[![arXiv:2309.01632](https://img.shields.io/badge/arXiv-2309.01632-b31b1b.svg?logo=arxiv)](https://arxiv.org/abs/2309.01632)
[![MIT license](https://img.shields.io/badge/License-MIT-blue.svg)](https://github.com/josefhoppe/edge-flow-cell-complexes/blob/main/LICENSE)
![uses Conda](https://img.shields.io/badge/Conda-44A833?logo=Anaconda&logoColor=white)
[![Snakemake 7.3 or higher](https://img.shields.io/badge/Snakemake-â‰¥7.3.0-039475.svg?logo=data:image/png;base64,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)](https://snakemake.readthedocs.io)


## About

This repository accompanies our paper linked above.
The code is split into two repositories:

- This repository contains the evaluation code and snakemake workflow.
- [Cell FLOWer](https://github.com/josefhoppe/cell-flower) is a separate package that contains only the code required for the inference and is published to PyPI.

```
@misc{hoppe2023representing,
      title={Representing Edge Flows on Graphs via Sparse Cell Complexes}, 
      author={Josef Hoppe and Michael T. Schaub},
      year={2023},
      eprint={2309.01632},
      archivePrefix={arXiv},
      primaryClass={cs.SI}
}
```

## Running numerical experiments

This project uses [Snakemake](https://snakemake.readthedocs.io).
To run the experiments:

1. Install [Miniconda](https://docs.conda.io/en/latest/miniconda.html) (or mamba)
2. Create a new conda environment and install dependencies: `conda env create -n cell-inference -f workflow/envs/environment.yaml`
3. Activate environment: `conda activate cell-inference`
4. Run snakemake: `snakemake -c20 all`

For us, running all experiments takes approximately three hours, so you may want to build individual artifacts instead, for example `snakemake -c20 figures/approx_exp_error.pdf`.

## Workflow structure

The Rulegraph gives a rough overview of the structure:

![Snakemake Rulegraph](readme_src/rules.png)

Generally, we aimed to give rules names that are short and easily understood.
For the different kinds of experiments, we used the following naming system:

- **approx_exp** - approximation experiment on synthetic data, i.e., how large is the approximation error?
- **inference_exp** - inference experiment on synthetic data, i.e., how many ground-truth cells have been recovered?
- **realworld_exp** - approximation experiment on realworld-data.
- **time_exp** - experiment to measure runtime performance.
- **heuristic_exp** - experiment to see how many ground-truth cells are detected by the heuristic (first iteration).

## Acknowledgements

Funded by the European Union (ERC, HIGH-HOPeS, 101039827). Views and opinions expressed are however those of the author(s) only and do not necessarily reflect those of the European Union or the European Research Council Executive Agency. Neither the European Union nor the granting authority can be held responsible for them.